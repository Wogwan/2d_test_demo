function plotVF_validate

format long
hold on;
syms x1 x2;
dom = 4;

%% sos_model 2d5
% Original system
% figure(20);clf;
% f = @(t,x) [
% x(2)-x(1)
% x(1)^2*x(2)-(exp(2*x(1))*cos(x(1))^2)^(1/4)+1];
%%
% figure(20);clf;
% m = 0.15;
% g = 9.8;
% l = 0.5;
% miu = 0.05;
% f = @(t,x) [
% x(2)
% g/l*sin(x(1))-miu/(m*l^2)*x(2)];
%%
% GP system
% figure(21);clf;
% f = @(t,x) [
% x(2); -(1-x(1))^2*x(1)-x(2)];
%%
figure(21);clf;
subplot(311);hold on;
f = @(t,x)[
    -1*x(1)+1*x(2);
    -1*x(1)-1*x(2)+1*x(1)*x(2)+0.5*(exp(x(1))-1)
    ];
%% Field [-2 2]
vectfield(f,-dom:0.4:dom,-dom:0.4:dom); hold on; % field [-5 5 -5 5]
for xd = -dom:dom/20:dom
    for yd = -dom:0.5:dom
        [ts,ys] = ode45(f,[0,20],[xd;yd]);
        h1 = plot(ys(:,1),ys(:,2), 'k');hold on;
    end
end
xlim([-dom dom]); ylim([-dom dom]);
plot(0,0,'c*','linewidth',2);hold on;
set(gca, 'LooseInset', [0,0,0,0]);
title('');

%%
subplot(312);hold on;
f = @(t,x)[
    x(2)-x(1)
    0.15432387994108778662817450645485*x(1)^4+0.23541948636981062330190921043309*x(1)^3+0.41058519554981867980300888929277*x(1)^2+x(1)*x(2)-0.46368439821849470143059572061854*x(1)+0.018934809918422834673634724822477*x(2)^4+0.053017123265488262651157214122577*x(2)^3+0.1081959091461522914912052328873*x(2)^2-0.9986920403516159766305754219573*x(2)-0.0018682553605258930828902919074608
    ];
%%
% % GP system
% figure(22);clf;
% f = @(t,x) [
% x(2)-x(1)
% x(1)^2*x(2)-0.000007031474139-0.500009736044418*x(1)+0.126057255453549*x(1)^2+0.103008552092872*x(1)^3-0.168853172050168 *x(1)^4+0.264932312148793*x(1)^5;
% ];
%% Plot ROA
% [ts1,ys1] = ode45(f,[0,20],[0.45;-0.51]);
% plot(ys1(:,1),ys1(:,2), 'r','linewidth',3), hold on;
%% Field [-2 2]
vectfield(f,-dom:0.4:dom,-dom:0.4:dom); hold on; % field [-5 5 -5 5]
for xd = -dom:dom/20:dom
    for yd = -dom:0.5:dom
        [ts,ys] = ode45(f,[0,40],[xd;yd]);
        h1 = plot(ys(:,1),ys(:,2), 'k');hold on;
    end
end
xlim([-dom dom]); ylim([-dom dom]);
plot(0,0,'c*','linewidth',2);hold on;
set(gca, 'LooseInset', [0,0,0,0]);
title('');
%%
subplot(313);hold on;
f = @(t,x)[
    x(2)-x(1)
    0.15432387994108778662817450645485*x(1)^4+0.23541948636981062330190921043309*x(1)^3+0.41058519554981867980300888929277*x(1)^2+x(1)*x(2)-0.46368439821849470143059572061854*x(1)+0.018934809918422834673634724822477*x(2)^4+0.053017123265488262651157214122577*x(2)^3+0.1081959091461522914912052328873*x(2)^2-0.9986920403516159766305754219573*x(2)-0.0018682553605258930828902919074608-0.1543090004809821*x(1)^4+7.519497170734121e-06*x(1)^3*x(2)-7.490647187817082e-05*x(1)^2*x(2)^2-5.139223046423028e-05*x(1)*x(2)^3-0.01889752836690075*x(2)^4-88.326552395698*x(1)^3-87.24118653414087*x(1)^2*x(2)+90.52045388853037*x(1)*x(2)^2-174.8013068514555*x(2)^3-0.3975731889726504*x(1)^2-0.9741408076665911*x(1)*x(2)-0.1129301879899078*x(2)^2-71.27826135880615*x(1)-144.2824628253677*x(2)+0.001866292714888158
    ];
%%
% % GP system
% figure(22);clf;
% f = @(t,x) [
% x(2)-x(1)
% x(1)^2*x(2)-0.000007031474139-0.500009736044418*x(1)+0.126057255453549*x(1)^2+0.103008552092872*x(1)^3-0.168853172050168 *x(1)^4+0.264932312148793*x(1)^5;
% ];
%% Plot ROA
% [ts1,ys1] = ode45(f,[0,20],[0.45;-0.51]);
% plot(ys1(:,1),ys1(:,2), 'r','linewidth',3), hold on;
%% Field [-2 2]
vectfield(f,-dom:0.4:dom,-dom:0.4:dom); hold on; % field [-5 5 -5 5]
for xd = -dom:dom/20:dom
    for yd = -dom:0.5:dom
        [ts,ys] = ode45(f,[0,20],[xd;yd]);
        h1 = plot(ys(:,1),ys(:,2), 'k');hold on;
    end
end
xlim([-dom dom]); ylim([-dom dom]);
plot(0,0,'c*','linewidth',2);hold on;
set(gca, 'LooseInset', [0,0,0,0]);
title('');
end