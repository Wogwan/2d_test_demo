clear all;
figure(200);clf;hold on;

sdpvar x1 x2 x3
%%
% vc = -11154.51967552443*x1^4+1.135913920002194*x1^3*x2+4.955118594070981*x1^3*x3+1171.840078989759*x1^2*x2^2-15.02990601369866*x1^2*x2*x3+21138.95310790373*x1^2*x3^2-6.189653081344577*x1*x2^3-6.041347173501446*x1*x2^2*x3+6.069007291799152*x1*x2*x3^2+2.099288457169987*x1*x3^3-93.09232391138393*x2^4+3.980296472031688*x2^3*x3-987.2454204626316*x2^2*x3^2+1.819554574488895*x2*x3^3-10085.20085196664*x3^4-3.90264724194604*x1^3-2.546733372542181*x1^2*x2-1.748490559079197*x1^2*x3+1.973311313870531*x1*x2^2+7.025110993477067*x1*x2*x3+8.942932559147787*x1*x3^2+2.947834262954737*x2^3+2.575829927090547*x2^2*x3-1.387124471681909*x2*x3^2-1.835427814430669*x3^3-0.08971485448317769*x1^2+0.3095104865629468*x1*x2+0.2408635828835946*x1*x3-1.1949744015814*x2^2-1.317929814293127*x2*x3-0.4552517850754649*x3^2-0.0001426841292988713*x1+0.0001020831374556339*x2+0.0001228298360055396*x3+998.8215452707433;
vc = -121959.4312569149*x1^4-117.3013711238206*x1^3*x2-76.1852710592138*x1^3*x3+11216.20240405218*x1^2*x2^2-191.1256976088257*x1^2*x2*x3+232693.571029056*x1^2*x3^2-0.4873354025619538*x1*x2^3-2.586355546720463*x1*x2^2*x3+118.7865132350911*x1*x2*x3^2+79.69408916428321*x1*x3^3-591.1573807923085*x2^4+15.04511737401478*x2^3*x3-10036.3527950988*x2^2*x3^2+165.0668414006425*x2*x3^3-111334.556026717*x3^4+124.9843419742002*x1^3+145.7988107471883*x1^2*x2+152.647545953327*x1^2*x3+1.517445957762969*x1*x2^2+9.883058004176474*x1*x2*x3-117.2418750988511*x1*x3^2-4.592094418681071*x2^3-2.836647239045653*x2^2*x3-142.4285850192186*x2*x3^2-151.2474875828111*x3^3-0.2423813856304576*x1^2+0.4392176553210365*x1*x2+0.2599254857245503*x1*x3-1.85598793611563*x2^2-2.389412578213349*x2*x3-1.098036314518962*x3^2-6.480779542664083e-05*x1+0.0002103229165422597*x2+0.000231802416073283*x3+1242.438460819903;
% vc = -1736956.63672226*x1^4-1831.46561840367*x1^3*x2-1165.419671890035*x1^3*x3+151594.3305487637*x1^2*x2^2-3372.377313719451*x1^2*x2*x3+3321462.069022676*x1^2*x3^2+106.1445945621502*x1*x2^3+39.56929496423027*x1*x2^2*x3+1724.263906984033*x1*x2*x3^2+1122.488952446171*x1*x3^3-5695.94585288409*x2^4+198.3862647861566*x2^3*x3-140179.9360450267*x2^2*x3^2+3152.634718476849*x2*x3^3-1590252.920462937*x3^4+3005.330306412093*x1^3+1910.100059297867*x1^2*x2+2142.38453512091*x1^2*x3-108.7796010393017*x1*x2^2+23.82992042328658*x1*x2*x3-2879.322623075818*x1*x3^2-89.72782076481042*x2^3-89.36523680822386*x2^2*x3-1816.112390893775*x2*x3^2-2051.73829443049*x3^3+10.0328095096463*x1^2-0.5199423501150391*x1*x2-1.522127931991821*x1*x3-5.762779976398856*x2^2-7.642540130131061*x2*x3-16.71172590337951*x3^2-0.01551473333727881*x1-0.0003955426268492361*x2-0.005528050472762131*x3+1739.919907592257;
vcs = char(sdisplay(vc));
dom = 10; xran=[-dom dom -dom dom -dom dom];
smrplot(vcs,0,xran,[200 100 80],'k-');
%% safety constraints
c1 = (x1+4)^2+(x2-6)^2+(x3+2)^2-4;
c2 = (x1+3)^2+(x2+4)^2+(x3+4)^2-4;
c3 = (x1-4)^2+(x2-0)^2+(x3-0)^2-5;
c4 = (x1+4)^2+(x2-2)^2+(x3-4)^2-5;
hold on;
c1s = char(sdisplay(c1));
c2s = char(sdisplay(c2));
c3s = char(sdisplay(c3));
c4s = char(sdisplay(c4));
smrplot(c1s,0,xran,[100 50 40],'r-');
smrplot(c2s,0,xran,[100 50 40],'r-');
smrplot(c3s,0,xran,[100 50 40],'r-');
smrplot(c4s,0,xran,[100 50 40],'r-');
xlabel('$x_1$','Interpreter','latex');
ylabel('$x_2$','Interpreter','latex');
zlabel('$x_3$','Interpreter','latex');
set(gcf, 'color', [1 1 1]);
x0=1;y0=0;width=5;height=5*0.75;
set(gcf,'units','inches','position',[x0,y0,width,height]) % set window size
