%%
figure(1000);clf;hold on;
pvar x1 x2 x3;
dom = 10;
domain = [-dom dom -dom dom -dom dom];
%%
C1 = (x1-3)^2+(x2-0)^2+(x3-0)^2-2;
C2 = (x1+4)^2+(x2+4)^2+(x3-4)^2-4;
C3 = (x1-0)^2+(x2-4)^2+(x3+0)^2-4;
C4 = (x1-4)^2+(x2-0)^2+(x3+4)^2-6;
C = [C2;C3;C4];
us2 = patch(pcontour3(C2,0,domain,'r'));          
set(us2, 'EdgeAlpha',0.05,'FaceColor', 'none', 'EdgeColor', 'k','LineStyle','--','LineWidth',1 ); hold on;
us3 = patch(pcontour3(C3,0,domain,'r'));           
set(us3, 'EdgeAlpha',0.05,'FaceColor', 'none', 'EdgeColor', 'k','LineStyle','--','LineWidth',1 ); hold on;
us4 = patch(pcontour3(C4,0,domain,'r'));           
set(us4, 'EdgeAlpha',0.05,'FaceColor', 'none', 'EdgeColor', 'k','LineStyle','--','LineWidth',1 ); hold on;
%%
%% Iter = 15 Permissive Barrier
B = 17365.25447007778348051942884922*x1^2*x3^2 - 772.97762945060708261735271662474*x2 - 950.78283091693867845606291666627*x3 - 11916.79233659101919329259544611*x1^2*x2^2 - 1127.0541170537956077168928459287*x1 + 48290.448345255470485426485538483*x2^2*x3^2 - 291.10539025282906777647440321743*x1*x2 - 702.48498440172909340617479756474*x1*x3 - 368.11648201315580308801145292819*x2*x3 - 2269.024202167850035039009526372*x1*x2^2 + 1023.782165231908606983779463917*x1^2*x2 - 3071.4743898837432425352744758129*x1*x2^3 + 4900.2261525390222232090309262276*x1*x3^2 + 728.82409038436787795944837853312*x1^2*x3 - 1377.9554799214677132113138213754*x1^3*x2 + 2429.2209307250018355262000113726*x1*x3^3 - 1392.8009350646709663124056532979*x2*x3^2 - 87.616144222155440957067185081542*x1^3*x3 + 1195.3361341340955732448492199183*x2^2*x3 - 1357.9066509522849628410767763853*x2*x3^3 + 1084.0180135997206889442168176174*x2^3*x3 - 237.52272231029201066121459007263*x1^2 - 1207.707956565701806539436802268*x1^3 + 246.64502890328370199313212651759*x2^2 - 3796.7118930366918903018813580275*x1^4 + 1338.475598779357369494391605258*x2^3 - 445.46831620041626820238889195025*x3^2 - 19110.490099057598854415118694305*x2^4 - 949.69843786950161756976740434766*x3^3 - 32343.761161970262037357315421104*x3^4 + 3803.5504555278575935517437756062*x1*x2*x3^2 - 1999.6906956040857039624825119972*x1*x2^2*x3 + 211.10160515196014330285834148526*x1^2*x2*x3 + 377.08242543314162276146817021072*x1*x2*x3 + 157361.34696154913399368524551392;
%%
inV = patch(pcontour3(B,0,domain,'b'));              
set(inV,'EdgeAlpha',1,'FaceColor', 'none', 'EdgeColor', 'r','LineStyle','-','LineWidth',1 ); hold on;
%%
b1 = 19.070580920191112284101109253243*x1^2*x2^2 - 1.3449220145719065211409315452329*x2 - 0.63931415139634972799598244819208*x3 - 0.51665207514675792754843541843002*x1 - 7.5587410598912496695334084506612*x1^2*x3^2 + 52.529109483836542437984462594613*x2^2*x3^2 + 0.6276729063836595789993566540943*x1*x2 + 0.31804769722346709626137339910201*x1*x3 - 0.51960613063290250757120247726562*x2*x3 + 5.3981912108447769327312926179729*x1*x2^2 + 1.5651204200977799629868059128057*x1^2*x2 - 1.351785326577941814818473176274*x1*x2^3 - 2.025109508803717428548907264485*x1*x3^2 - 0.24790751566996313548507657742448*x1^2*x3 - 0.19083611609491041294361934888002*x1^3*x2 + 1.4769627630638084703207368875155*x1*x3^3 + 1.4581761210155732566562392094056*x2*x3^2 + 0.52581335307906540421640784188639*x1^3*x3 + 0.036178492791343538903525711702969*x2^2*x3 + 0.60190291363996817342041367737693*x2*x3^3 + 0.029106171817219691350109300742588*x2^3*x3 - 0.66394156337324961025814218373853*x1^2 - 0.66177854489157916795250002905959*x1^3 + 0.36391179563183045919672053969407*x2^2 - 6.3180155338304322398812473693397*x1^4 - 0.85991617602487713245551503860042*x2^3 - 1.8869540995580362796602003072621*x3^2 - 37.266838805981521431931469123811*x2^4 - 0.58413920712958222747346326286788*x3^3 - 22.469675879813699737042043125257*x3^4 - 0.41009664590998567978985533954983*x1*x2*x3^2 - 0.58786617300869847824174030392896*x1*x2^2*x3 + 0.79490593946209398001911949904752*x1^2*x2*x3 - 0.91756983118045298830622868990758*x1*x2*x3 + 604.22527362036964859726140275598;
B1 = patch(pcontour3(b1,0,domain,'b'));             
set(B1,'EdgeAlpha',0.4,'FaceColor', 'none', 'EdgeColor', 'g','LineStyle',':','LineWidth',1); hold on;
xlim([-dom dom]); ylim([-dom dom]); zlim([-dom dom]);view(-200, 10);hold on;
%%
legend([inV,B1],{'$B(x)\geq 0$','$B^*(x)\geq 0$'}, 'Interpreter','latex','location','northwest');
title('');xlabel('$x_1$','Interpreter','latex','Fontsize',18);
ylabel('$x_2$','Interpreter','latex','Fontsize',18);
zlabel('$x_3$','Interpreter','latex','Fontsize',18);
set(gca,'xtick',[-dom,-dom/2,0,dom/2,dom]);
set(gca,'ytick',[-dom,-dom/2,0,dom/2,dom]);
set(gca,'ztick',[-dom,-dom/2,0,dom/2,dom]);
set(gca,'Box','on');view(200,10);
set(gca,'FontSize',22,'Fontname','Times','LineWidth',2);
set(gca,'LooseInset',get(gca,'TightInset'))

