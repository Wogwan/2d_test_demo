figure(99999999);clf
syms x1 x2 x3;

box on;
view(-150, 30);hold on;
% plot3(0,0,0,'co','linewidth',2);hold on;



%%
pvar x1 x2 x3;
%% Initial Barrier function with autonomous system
B_0 = -926163.9939077364*x1^6+257027.8194382421*x1^5*x2+1114280.643786584*x1^5*x3+201240.346766742*x1^4*x2^2-263537.4669273091*x1^4*x2*x3-1410172.924076108*x1^4*x3^2-620021.4707155579*x1^3*x2^3-470731.5188031173*x1^3*x2^2*x3+317313.2904248089*x1^3*x2*x3^2+87524.32825363729*x1^3*x3^3-1750806.968972303*x1^2*x2^4+11797.01047546853*x1^2*x2^3*x3+1885958.774594082*x1^2*x2^2*x3^2-15661.03621528457*x1^2*x2*x3^3-2658944.807774647*x1^2*x3^4+161311.6659057942*x1*x2^5+1720917.65384088*x1*x2^4*x3+33510.17871710166*x1*x2^3*x3^2-548727.4794381509*x1*x2^2*x3^3-283738.5365229551*x1*x2*x3^4-1419784.451496469*x1*x3^5-142597.4104408523*x2^6+52138.6132987351*x2^5*x3-163184.3653689249*x2^4*x3^2+166950.0761301221*x2^3*x3^3-566806.182745123*x2^2*x3^4-239442.1396904833*x2*x3^5-642690.1133243747*x3^6-696830.9098147663*x1^5+330862.4377695156*x1^4*x2+1807509.806103987*x1^4*x3+837267.4911669964*x1^3*x2^2-23873.92242735565*x1^3*x2*x3+1170593.804869505*x1^3*x3^2-518019.1556930111*x1^2*x2^3+65372.33762398906*x1^2*x2^2*x3+445767.6496450633*x1^2*x2*x3^2+2459826.248696288*x1^2*x3^3-3245365.199848898*x1*x2^4-358203.7729891831*x1*x2^3*x3+1662729.359506953*x1*x2^2*x3^2-176631.4041140994*x1*x2*x3^3-4342254.528352661*x1*x3^4+19659.23283137218*x2^5+2043286.429218962*x2^4*x3+78317.54957940077*x2^3*x3^2-1414691.956066933*x2^2*x3^3-295160.6190596161*x2*x3^4-1330259.439048674*x3^5-832587.9732691126*x1^4-63982.40805285073*x1^3*x2-1200522.69071716*x1^3*x3+1180223.636218488*x1^2*x2^2+540692.9352467548*x1^2*x2*x3+8238006.592535419*x1^2*x3^2+502486.5898205069*x1*x2^3+2340828.244666143*x1*x2^2*x3
+292984.6384099874*x1*x2*x3^2+4250629.284472954*x1*x3^3-1910669.519192282*x2^4-585297.0300103959*x2^3*x3+1328395.139199292*x2^2*x3^2+122192.1497847754*x2*x3^3-1243560.679877585*x3^4-1099835.963070786*x1^3-641480.9197385721*x1^2*x2-6280329.881647754*x1^2*x3-1015385.743818734*x1*x2^2+706630.9776949236*x1*x2*x3+5693445.394214684*x1*x3^2+593160.1654524104*x2^3+2109817.351721545*x2^2*x3+149805.8508851641*x2*x3^2+2589330.924597146*x3^3-199481.3337080848*x1^2-738979.0011165645*x1*x2-6346397.498020018*x1*x3-1108576.644199351*x2^2+343716.3917563515*x2*x3+726243.6550288534*x3^2+1496846.595672866*x1-309236.6831834472*x2-2509456.197763228*x3+411103.3481464338%% Initial Lyapunov function




% domain = [-2 2 -2 2 -2 2];
C0 = 5e-3;
V = 10*x1^4+1*x2^4+20*x3^4+2*x1^2*x2^2-4*x3^2*x2^2+3*x1^2*x3^2;


h_t = h_ttt(i);
ph4 = patch(pcontour3(h_t,0,domain));             % Plot the original Lyapunov sublevel set
set(ph4, 'FaceAlpha',0.01,'EdgeAlpha',0.05,'FaceColor', 'none', 'EdgeColor', 'b','LineStyle','--','LineWidth',0.7 ); hold on;


xlim([-2 2]); ylim([-2 2]); zlim([-2 2]);hold on; 

hold on;
ph1= patch(pcontour3(V,double(C0),domain,'c')); hold on;             % Plot the original Lyapunov sublevel set
set(ph1,  'FaceAlpha',0.01,'EdgeAlpha',0.6,'FaceColor', 'none', 'EdgeColor', 'r' ,'LineStyle','-','LineWidth',1 );hold on;


%%
% legend([ph4,ph1,h1],{'$h(x)\geq 0$','$V(x)\leq c_0$','$Vector Field$'}, 'Interpreter','latex','location','northwest');
legend([ph4,ph1],{'$h(x)\geq 0$','$V(x)\leq c_0$'}, 'Interpreter','latex','location','northwest');


title('');
xlabel('$x_1$','Interpreter','latex','Fontsize',18);
ylabel('$x_2$','Interpreter','latex','Fontsize',18);
zlabel('$x_3$','Interpreter','latex','Fontsize',18);
set(gca,'xtick',[-2,0,2]);
set(gca,'ytick',[-2,0,2]);
set(gca,'ztick',[-2,0,2]);
