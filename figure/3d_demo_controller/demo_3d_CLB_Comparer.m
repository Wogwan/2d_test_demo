%%
figure(1000);clf;hold on;
pvar x1 x2 x3;
dom = 10;
domain = [-dom dom -dom dom -dom dom];
%%
C1 = (x1-3)^2+(x2-0)^2+(x3-0)^2-2;
C2 = (x1+3)^2+(x2+3)^2+(x3-3)^2-3;
C3 = (x1-0)^2+(x2-3)^2+(x3+0)^2-3;
C4 = (x1-3)^2+(x2-0)^2+(x3+3)^2-3;
C = [C2;C3;C4];
us2 = patch(pcontour3(C2,0,domain,'r'));          
set(us2, 'EdgeAlpha',0.05,'FaceColor', 'none', 'EdgeColor', 'k','LineStyle','--','LineWidth',1 ); hold on;
us3 = patch(pcontour3(C3,0,domain,'r'));           
set(us3, 'EdgeAlpha',0.05,'FaceColor', 'none', 'EdgeColor', 'k','LineStyle','--','LineWidth',1 ); hold on;
us4 = patch(pcontour3(C4,0,domain,'r'));           
set(us4, 'EdgeAlpha',0.05,'FaceColor', 'none', 'EdgeColor', 'k','LineStyle','--','LineWidth',1 ); hold on;
%%
%% Iter = 15 Permissive Barrier
B = -33.09799065631322*x1^4-0.1723940535235186*x1^3*x2+0.143773053054076*x1^3*x3+64.97440396738463*x1^2*x2^2+0.5857519399089953*x1^2*x2*x3+0.7853770480884856*x1^2*x3^2-0.1464069860009552*x1*x2^3+0.6329928141778013*x1*x2^2*x3-0.473659248816281*x1*x2*x3^2-0.002587119356487314*x1*x3^3-33.13600573019499*x2^4+0.2011955362302861*x2^3*x3+0.8363351627078721*x2^2*x3^2-0.008256353299219281*x2*x3^3-1.210752988753422*x3^4+0.03300523248034432*x1^3+0.2919835081240157*x1^2*x2-0.3520772263533318*x1^2*x3+0.2881701361665453*x1*x2^2-0.6594226500297575*x1*x2*x3+0.3477597557977948*x1*x3^2-0.01061756528631267*x2^3-0.2735051471964477*x2^2*x3+0.3933491595576186*x2*x3^2-0.04673337103910956*x3^3-0.1235693086447572*x1^2-0.1032576701015931*x1*x2+0.1100941857098174*x1*x3-0.07054903680735992*x2^2+0.1186658561714403*x2*x3-0.1787005411543669*x3^2-0.0001237346321703398*x1-0.0001309891038417597*x2+0.0001719599364048977*x3+75.32430532143852;
%%
inV = patch(pcontour3(B,0,domain,'b'));              
set(inV,'EdgeAlpha',1,'FaceColor', 'none', 'EdgeColor', 'r','LineStyle','-','LineWidth',1 ); hold on;
%%
b1 = -479.6017615667764*x1^4-15.86133700042128*x1^3*x2+8.209676345357087*x1^3*x3+962.3680606514854*x1^2*x2^2-9.183369430184193*x1^2*x2*x3-8.948272097578336*x1^2*x3^2+11.44009068477429*x1*x2^3+2.260778074698186*x1*x2^2*x3-7.997581140333621*x1*x2*x3^2+1.828680049425091*x1*x3^3-490.0154204139453*x2^4+20.26053585026532*x2^3*x3+5.892629772747223*x2^2*x3^2+1.633264124931878*x2*x3^3-2.554910154185652*x3^4+0.4787192743330786*x1^3+4.059372282616899*x1^2*x2-4.090107722549472*x1^2*x3+3.825277143310034*x1*x2^2-7.638982883282898*x1*x2*x3+3.349597710311701*x1*x3^2+0.2346934083738213*x2^3-1.391282574479294*x2^2*x3+3.304168447824369*x2*x3^2-2.119114752497959*x3^3-0.4669021407545277*x1^2-0.8580979975546517*x1*x2+0.9873801498646952*x1*x3-0.4569810723518573*x2^2+1.052546264077701*x2*x3-1.128864863002186*x3^2-0.0009808221058563173*x1-0.001081186402740428*x2+0.001571647333282484*x3+1068.179609457146;
B1 = patch(pcontour3(b1,0,domain,'b'));             
set(B1,'EdgeAlpha',0.4,'FaceColor', 'none', 'EdgeColor', 'g','LineStyle',':','LineWidth',1); hold on;
xlim([-dom dom]); ylim([-dom dom]); zlim([-dom dom]);view(-200, 10);hold on;
%%
legend([inV,B1],{'$B(x)\geq 0$','$B^*(x)\geq 0$'}, 'Interpreter','latex','location','northwest');
title('');xlabel('$x_1$','Interpreter','latex','Fontsize',18);
ylabel('$x_2$','Interpreter','latex','Fontsize',18);
zlabel('$x_3$','Interpreter','latex','Fontsize',18);
set(gca,'xtick',[-dom,-dom/2,0,dom/2,dom]);
set(gca,'ytick',[-dom,-dom/2,0,dom/2,dom]);
set(gca,'ztick',[-dom,-dom/2,0,dom/2,dom]);
set(gca,'Box','on');view(200,10);
set(gca,'FontSize',22,'Fontname','Times','LineWidth',2);
set(gca,'LooseInset',get(gca,'TightInset'))

